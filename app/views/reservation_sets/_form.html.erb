<% content_for :head do %>
	<script type="text/javascript">
		function add_fields(link, association, content) {  
		    var new_id = new Date().getTime();  
		    var regexp = new RegExp("new_" + association, "g");  
		    $(link).before(content.replace(regexp, new_id));  
		};
	</script>
<% end %>

<% if params[:location_id] != nil %>
	<%= form_for([@location.user,@location,@reservation_set]) do |f| %>
   
 		<% if @reservation_set.errors.any? %>
    		<div id="error_explanation">
      			<h2><%= pluralize(@pass_set.errors.count, "error") %> prohibited this reservation set from being saved:</h2>
      			<ul>
      				<% @reservation_set.errors.full_messages.each do |msg| %>
        				<li><%= msg %></li>
      				<% end %>
      			</ul>
    		</div>
  		<% end %>
	
		<%= f.fields_for :fecha do |builder| %>
			<div class="field">
				<%= builder.label :date %><br />
	    		<%= builder.date_select :date %>
			</div>
		<% end %>

  		<div class="field">
    		<%= f.label :total_released_reservations %><br />
    		<%= f.number_field :total_released_reservations %>
  		</div>

		<%= f.fields_for :price_points do |builder| %>
			<div class="field">
				<%= render 'price_point_fields', :f => builder %>
			</div>
		<% end %>
		<%= link_to_add_fields "Add Different Price Point", f, :price_points %>

  		<div class="actions">
    		<%= f.submit %>
  		</div>
	<% end %>
<% elsif params[:event_id] != nil %>
	<%= form_for([@event.user,@event,@reservation_set]) do |f| %>
   
 		<% if @reservation_set.errors.any? %>
    		<div id="error_explanation">
      			<h2><%= pluralize(@reservation_set.errors.count, "error") %> prohibited this reservation set from being saved:</h2>
      			<ul>
      				<% @reservation_set.errors.full_messages.each do |msg| %>
        				<li><%= msg %></li>
      				<% end %>
      			</ul>
    		</div>
  		<% end %>
	
		<%= f.fields_for :fecha do |builder| %>
			<div class="field">
				<%= builder.label :date %><br />
	    		<%= builder.date_select :date %>
			</div>
		<% end %>

  		<div class="field">
    		<%= f.label :total_released_reservations %><br />
    		<%= f.number_field :total_released_reservations %>
  		</div>

		<%= f.fields_for :price_points do |builder| %>
			<div class="field">
				<%= render 'price_point_fields', :f => builder %>
			</div>
		<% end %>
		<%= link_to_add_fields "Add Different Price Point", f, :price_points %>

  		<div class="actions">
    		<%= f.submit %>
  		</div>
	<% end %>
<% end %>
